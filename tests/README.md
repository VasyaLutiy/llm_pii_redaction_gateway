# üß™ –¢–µ—Å—Ç—ã LLM PII Proxy

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã –¥–ª—è LLM PII Proxy, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ —Ç–∏–ø–∞–º.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ unit/           # Unit —Ç–µ—Å—Ç—ã (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
‚îú‚îÄ‚îÄ integration/    # Integration —Ç–µ—Å—Ç—ã (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
‚îú‚îÄ‚îÄ e2e/           # End-to-end —Ç–µ—Å—Ç—ã (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞)
‚îî‚îÄ‚îÄ run_all_tests.py  # –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```

### üîß Unit —Ç–µ—Å—Ç—ã (`unit/`)
- `test_centralized_config.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `test_pii_patterns_fixed.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PII –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- `test_pii_enabled.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–∏—è PII –∑–∞—â–∏—Ç—ã
- `test_pii_with_llm_service.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ LLM —Å–µ—Ä–≤–∏—Å–∞ —Å PII

### üîó Integration —Ç–µ—Å—Ç—ã (`integration/`)
- `test_pii_integration.py` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PII
- `test_cursor_tools.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ Cursor
- `test_cursor_simulation.py` - –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è Cursor
- `test_cursor_exact.py` - –¢–æ—á–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ Cursor
- `test_full_tool_cycle.py` - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª tool calling

### üåê E2E —Ç–µ—Å—Ç—ã (`e2e/`)
- `test_real_llm_with_pii.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω–æ–π LLM –∏ PII
- `test_http_api_with_pii.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP API —Å PII

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```bash
cd llm_pii_proxy/tests
python run_all_tests.py
```

### –ó–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
```bash
cd llm_pii_proxy/tests

# Unit —Ç–µ—Å—Ç—ã
python unit/test_pii_patterns_fixed.py
python unit/test_centralized_config.py

# Integration —Ç–µ—Å—Ç—ã
python integration/test_cursor_tools.py
python integration/test_pii_integration.py

# E2E —Ç–µ—Å—Ç—ã (—Ç—Ä–µ–±—É—é—Ç –∑–∞–ø—É—â–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä)
python e2e/test_http_api_with_pii.py
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø–æ —Ç–∏–ø–∞–º
```bash
cd llm_pii_proxy/tests

# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
python unit/test_*.py

# –¢–æ–ª—å–∫–æ integration —Ç–µ—Å—Ç—ã
python integration/test_*.py

# –¢–æ–ª—å–∫–æ e2e —Ç–µ—Å—Ç—ã
python e2e/test_*.py
```

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### –î–ª—è Unit –∏ Integration —Ç–µ—Å—Ç–æ–≤:
- Python 3.8+
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `requirements_llm_proxy.txt`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Azure OpenAI

### –î–ª—è E2E —Ç–µ—Å—Ç–æ–≤:
- –ó–∞–ø—É—â–µ–Ω–Ω—ã–π LLM PII Proxy —Å–µ—Ä–≤–µ—Ä –Ω–∞ `http://192.168.0.182:8000`
- –î–æ—Å—Ç—É–ø –∫ Azure OpenAI API

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

–¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `AZURE_OPENAI_ENDPOINT` - Endpoint Azure OpenAI
- `AZURE_OPENAI_API_KEY` - API –∫–ª—é—á Azure OpenAI
- `AZURE_COMPLETIONS_MODEL` - –ú–æ–¥–µ–ª—å –¥–ª—è completions
- `PII_PROTECTION_ENABLED` - –í–∫–ª—é—á–µ–Ω–∏–µ PII –∑–∞—â–∏—Ç—ã (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–∞–º–∏)

## üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –í—Å–µ assertions –ø—Ä–æ—à–ª–∏
- –ö–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ 0
- –í—ã–≤–æ–¥–∏—Ç—Å—è "‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù"

### ‚ùå –ü—Ä–æ–≤–∞–ª–∏–≤—à–∏–µ—Å—è —Ç–µ—Å—Ç—ã
- –ï—Å—Ç—å failed assertions
- –ö–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ != 0
- –í—ã–≤–æ–¥–∏—Ç—Å—è "‚ùå –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù"

### ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- –¢–µ—Å—Ç –ø—Ä–æ—à–µ–ª, –Ω–æ –µ—Å—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- –û–±—ã—á–Ω–æ —Å–≤—è–∑–∞–Ω–æ —Å –Ω–µ–ø–æ–ª–Ω—ã–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–π

## üêõ –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
export PII_PROXY_DEBUG=true
python unit/test_pii_patterns_fixed.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
python unit/test_centralized_config.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Azure
```bash
python integration/test_cursor_tools.py
```

## üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –ø–∞–ø–∫–µ (`unit/`, `integration/`, `e2e/`)
2. –ù–∞—á–Ω–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ —Å `test_`
3. –î–æ–±–∞–≤—å—Ç–µ –ø—É—Ç—å –∫ –∫–æ—Ä–Ω—é –ø—Ä–æ–µ–∫—Ç–∞ –≤ –∏–º–ø–æ—Ä—Ç—ã:
   ```python
   import sys
   import os
   sys.path.insert(0, os.path.join(os.path.dirname(__file__), '../../..'))
   ```
4. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
5. –°–æ–∑–¥–∞–π—Ç–µ async —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
6. –î–æ–±–∞–≤—å—Ç–µ `if __name__ == "__main__":` –±–ª–æ–∫ –¥–ª—è –∑–∞–ø—É—Å–∫–∞

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞

–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ PII –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Tool calling —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ HTTP API endpoints
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Azure OpenAI
- ‚úÖ End-to-end —Å—Ü–µ–Ω–∞—Ä–∏–∏

–¶–µ–ª—å: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ >80% –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. 